angular.module("portfolioApp",["ngSanitize","ngRoute"]).constant("AppConfig",{}).config(["$sceDelegateProvider",function($sceDelegateProvider){}]).config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(true);$locationProvider.hashPrefix("!")}]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"ng/views/index.html",controller:"indexCtrl",controllerAs:"indexCtrl"}).when("/experiences/:experienceUrl/",{templateUrl:"ng/views/experience.html",controller:"experienceCtrl",controllerAs:"experienceCtrl"}).when("/projects/:projectUrl/",{templateUrl:"ng/views/project.html",controller:"projectCtrl",controllerAs:"projectCtrl"}).when("/skills/:skill/",{templateUrl:"ng/views/skill.html",controller:"skillCtrl",controllerAs:"skillCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","$window",function($rootScope,$location,$window){$window.ga("create","UA-74460275-1","auto");$rootScope.$on("$routeChangeSuccess",function(){ga("send","pageview",$location.path())})}]);(function(){angular.module("portfolioApp").controller("experienceCtrl",["$routeParams","portfolioData",experienceCtrlFunc]);function experienceCtrlFunc($routeParams,portfolioData){var self=this;portfolioData.getExperience($routeParams.experienceUrl).then(function(data){self.experience=data})}})();(function(){angular.module("portfolioApp").controller("indexCtrl",["portfolioData",indexCtrlFunc]);function indexCtrlFunc(portfolioData){var self=this;portfolioData.getPortfolio().then(function(data){self.portfolio=data})}})();(function(){angular.module("portfolioApp").controller("mainCtrl",[mainCtrlFunc]);function mainCtrlFunc(){var self=this;self.copyYear=(new Date).getFullYear()}})();(function(){angular.module("portfolioApp").controller("projectCtrl",["$routeParams","portfolioData",projectCtrlFunc]);function projectCtrlFunc($routeParams,portfolioData){var self=this;portfolioData.getProject($routeParams.projectUrl).then(function(data){self.project=data})}})();(function(){angular.module("portfolioApp").controller("skillCtrl",["$routeParams","portfolioData",skillCtrlFunc]);function skillCtrlFunc($routeParams,portfolioData){var self=this;portfolioData.getSkill($routeParams.skill).then(function(data){self.skillTitle=$routeParams.skill.replace(/-/g," ");self.skillWork=data})}})();(function(){angular.module("portfolioApp").directive("card",[cardFunc]);function cardFunc(){return{restrict:"AE",replace:true,controller:cardCtrlFunc,controllerAs:"cardCtrl",bindToController:true,scope:{details:"=",featured:"@"},templateUrl:"ng/partials/card.html"};function cardCtrlFunc(){var self=this;self.buildUrl=function(item){var url="/";if(item.timeframe){url+="experiences"}else{url+="projects"}url+="/"+item.url+"/";return url}}}})();(function(){angular.module("portfolioApp").directive("photoGallery",[photoGalleryFunc]);function photoGalleryFunc(){return{restrict:"AE",replace:true,controller:["$document","$scope","$q",photoGalleryCtrlFunc],controllerAs:"photoGalleryCtrl",bindToController:true,scope:{gallery:"=",prefix:"@"},templateUrl:"ng/partials/photoGallery.html"};function photoGalleryCtrlFunc($document,$scope,$q){var self=this;self.index;self.viewingImage={};function loadImage(url){var deferred=$q.defer();var image=new Image;image.onload=function(){self.loading=false;if(typeof this.complete===false||this.naturalWidth===0){deferred.reject()}deferred.resolve(image)};image.onerror=function(){deferred.reject()};image.src=url;self.loading=true;return deferred.promise}function getImage(index){var request="/images/shots/full/"+self.prefix+(index+1)+".png";loadImage(request).then(function(image){self.viewingImage=request;self.error=false},function(){self.error=true})}self.openGallery=function(index){self.index=index;self.open=true;getImage(index)};self.closeGallery=function(){self.open=false};self.switchImage=function(increment){self.index=self.index+increment;if(self.index<0){self.index=self.gallery.length-1}else if(self.index===self.gallery.length){self.index=0}getImage(self.index)};angular.element($document[0].body).on("keydown",function(e){if(!self.open){return}var key=e.which;if(key===27){self.closeGallery()}else if(key===39){self.switchImage(1)}else if(key===37){self.switchImage(-1)}$scope.$apply()})}}})();(function(){angular.module("portfolioApp").directive("skill",[skillFunc]);function skillFunc(){return{restrict:"AE",replace:true,controller:skillCtrlFunc,controllerAs:"skillCtrl",bindToController:true,scope:{details:"="},templateUrl:"ng/partials/skill.html"};function skillCtrlFunc(){var self=this;if(typeof self.details=="string"){var temp={skill:self.details};self.details=temp}}}})();(function(){angular.module("portfolioApp").filter("slugify",[function(){return function(input){return input.replace(/ /g,"-")}}])})();(function(){angular.module("portfolioApp").factory("portfolioData",["$http","$q",portfolioDataFunc]);function portfolioDataFunc($http,$q){var portfolio;function getPortfolio(){if(portfolio){return $q.when(portfolio)}else{return $http.get("data/port.json",{cache:true}).then(function(data){portfolio=data.data;portfolio.everything=[];portfolio.everything=portfolio.everything.concat(portfolio.a);portfolio.everything=portfolio.everything.concat(portfolio.b);portfolio.skills=getSkills(portfolio);return portfolio})}}function getExperience(experienceUrl){return getPortfolio().then(function(portfolio){return _.findWhere(portfolio.a,{url:experienceUrl})})}function getProject(projectUrl){return getPortfolio().then(function(portfolio){return _.findWhere(portfolio.b,{url:projectUrl})})}function getSkill(skillName){skillName=skillName.replace(/-/g," ");return getPortfolio().then(function(portfolio){return _.filter(portfolio.everything,function(obj){if(obj.skills.indexOf(skillName)>-1){return true}return false})})}return{getPortfolio:getPortfolio,getExperience:getExperience,getProject:getProject,getSkill:getSkill};function getSkills(portfolio){var skillsUnsorted=_.pluck(portfolio.everything,"skills");return frequency(_.flatten(skillsUnsorted,true))}function frequency(arr){var result=[];for(var i=0;i<arr.length;i++){var match=_.findWhere(result,{skill:arr[i]});if(match){match.count+=1}else{var count=1;switch(arr[i]){case"AngularJS":count=520;break;case"JavaScript":count=499;break;case"GruntJS":count=498;break;case"CSS3":count=497;break;case"HTML5":count=496;break;case"jQuery":count=495;break;case"Unit Tests":count=494;break;case"JasmineJS":count=493;break;case"Karma":count=492;break;case"Django":count=491;break}result.push({skill:arr[i],count:count})}}return _.sortBy(result,"count").reverse()}}})();